import { BehaviorSubject } from 'rxjs';
import { PrintDriver } from "./PrintDriver";
// @ts-ignore
import { StarWebPrintTrader } from '../js/StarWebPrintTrader.mjs';
export class WebPrintDriver extends PrintDriver {
    constructor(url, useSecure = false) {
        super();
        this.isConnected = new BehaviorSubject(false);
        this.useSecure = false;
        this.isStarPrinter = false;
        this.url = url;
        this.useSecure = useSecure;
    }
    connect() {
        const useSecure = (this.useSecure) ? 's' : '';
        this.trader = new StarWebPrintTrader({ url: `http${useSecure}://${this.url}/StarWebPRNT/SendMessage` });
        this.trader.onReceive = (response) => {
            this.isConnected.next(true);
        };
        this.trader.onError = (response) => {
            this.isConnected.next(false);
        };
        this.trader.sendMessage('');
    }
    async write(data) {
        this.trader.sendMessage({ request: data });
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiV2ViUHJpbnREcml2ZXIuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi9wcm9qZWN0cy9wb3MtY2FzaGllci1wcmludGVyL3NyYy9saWIvZHJpdmVycy9XZWJQcmludERyaXZlci50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQUUsZUFBZSxFQUFFLE1BQU0sTUFBTSxDQUFDO0FBQ3ZDLE9BQU8sRUFBRSxXQUFXLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFDNUMsYUFBYTtBQUNiLE9BQU8sRUFBRSxrQkFBa0IsRUFBRSxNQUFNLDhCQUE4QixDQUFDO0FBRWxFLE1BQU0sT0FBTyxjQUFlLFNBQVEsV0FBVztJQVEzQyxZQUFZLEdBQVcsRUFBRSxZQUFxQixLQUFLO1FBQy9DLEtBQUssRUFBRSxDQUFDO1FBUkwsZ0JBQVcsR0FBNkIsSUFBSSxlQUFlLENBQVUsS0FBSyxDQUFDLENBQUM7UUFHM0UsY0FBUyxHQUFZLEtBQUssQ0FBQztRQUM1QixrQkFBYSxHQUFZLEtBQUssQ0FBQztRQUtsQyxJQUFJLENBQUMsR0FBRyxHQUFHLEdBQUcsQ0FBQztRQUNmLElBQUksQ0FBQyxTQUFTLEdBQUcsU0FBUyxDQUFDO0lBQy9CLENBQUM7SUFFTSxPQUFPO1FBQ1YsTUFBTSxTQUFTLEdBQUcsQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDO1FBQzlDLElBQUksQ0FBQyxNQUFNLEdBQUcsSUFBSSxrQkFBa0IsQ0FBQyxFQUFFLEdBQUcsRUFBRSxPQUFPLFNBQVMsTUFBTSxJQUFJLENBQUMsR0FBRywwQkFBMEIsRUFBRSxDQUFDLENBQUM7UUFFeEcsSUFBSSxDQUFDLE1BQU0sQ0FBQyxTQUFTLEdBQUcsQ0FBQyxRQUFhLEVBQUUsRUFBRTtZQUN0QyxJQUFJLENBQUMsV0FBVyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQztRQUNoQyxDQUFDLENBQUE7UUFFRCxJQUFJLENBQUMsTUFBTSxDQUFDLE9BQU8sR0FBRyxDQUFDLFFBQWEsRUFBRSxFQUFFO1lBQ3BDLElBQUksQ0FBQyxXQUFXLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDO1FBQ2pDLENBQUMsQ0FBQTtRQUNELElBQUksQ0FBQyxNQUFNLENBQUMsV0FBVyxDQUFDLEVBQUUsQ0FBQyxDQUFDO0lBQ2hDLENBQUM7SUFFTSxLQUFLLENBQUMsS0FBSyxDQUFDLElBQVk7UUFDM0IsSUFBSSxDQUFDLE1BQU0sQ0FBQyxXQUFXLENBQUMsRUFBRSxPQUFPLEVBQUUsSUFBSSxFQUFFLENBQUMsQ0FBQztJQUMvQyxDQUFDO0NBRUoiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBCZWhhdmlvclN1YmplY3QgfSBmcm9tICdyeGpzJztcclxuaW1wb3J0IHsgUHJpbnREcml2ZXIgfSBmcm9tIFwiLi9QcmludERyaXZlclwiO1xyXG4vLyBAdHMtaWdub3JlXHJcbmltcG9ydCB7IFN0YXJXZWJQcmludFRyYWRlciB9IGZyb20gJy4uL2pzL1N0YXJXZWJQcmludFRyYWRlci5tanMnO1xyXG5cclxuZXhwb3J0IGNsYXNzIFdlYlByaW50RHJpdmVyIGV4dGVuZHMgUHJpbnREcml2ZXIge1xyXG4gICAgcHVibGljIGlzQ29ubmVjdGVkOiBCZWhhdmlvclN1YmplY3Q8Ym9vbGVhbj4gPSBuZXcgQmVoYXZpb3JTdWJqZWN0PGJvb2xlYW4+KGZhbHNlKTtcclxuICAgIHByaXZhdGUgdHJhZGVyOiBhbnk7XHJcbiAgICBwcml2YXRlIHVybDogc3RyaW5nO1xyXG4gICAgcHJpdmF0ZSB1c2VTZWN1cmU6IGJvb2xlYW4gPSBmYWxzZTtcclxuICAgIHB1YmxpYyBpc1N0YXJQcmludGVyOiBib29sZWFuID0gZmFsc2U7XHJcblxyXG5cclxuICAgIGNvbnN0cnVjdG9yKHVybDogc3RyaW5nLCB1c2VTZWN1cmU6IGJvb2xlYW4gPSBmYWxzZSkge1xyXG4gICAgICAgIHN1cGVyKCk7XHJcbiAgICAgICAgdGhpcy51cmwgPSB1cmw7XHJcbiAgICAgICAgdGhpcy51c2VTZWN1cmUgPSB1c2VTZWN1cmU7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIGNvbm5lY3QoKSB7XHJcbiAgICAgICAgY29uc3QgdXNlU2VjdXJlID0gKHRoaXMudXNlU2VjdXJlKSA/ICdzJyA6ICcnO1xyXG4gICAgICAgIHRoaXMudHJhZGVyID0gbmV3IFN0YXJXZWJQcmludFRyYWRlcih7IHVybDogYGh0dHAke3VzZVNlY3VyZX06Ly8ke3RoaXMudXJsfS9TdGFyV2ViUFJOVC9TZW5kTWVzc2FnZWAgfSk7XHJcblxyXG4gICAgICAgIHRoaXMudHJhZGVyLm9uUmVjZWl2ZSA9IChyZXNwb25zZTogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuaXNDb25uZWN0ZWQubmV4dCh0cnVlKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMudHJhZGVyLm9uRXJyb3IgPSAocmVzcG9uc2U6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLmlzQ29ubmVjdGVkLm5leHQoZmFsc2UpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLnRyYWRlci5zZW5kTWVzc2FnZSgnJyk7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIGFzeW5jIHdyaXRlKGRhdGE6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xyXG4gICAgICAgIHRoaXMudHJhZGVyLnNlbmRNZXNzYWdlKHsgcmVxdWVzdDogZGF0YSB9KTtcclxuICAgIH1cclxuXHJcbn0iXX0=